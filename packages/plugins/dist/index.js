import{Hono as y}from"hono";import{serveStatic as d}from"@hono/node-server/serve-static";import c from"nunjucks";import f from"fs";import o from"path";import v from"js-yaml";import w from"markdown-it";import k from"markdown-it-anchor";import h from"highlight.js/lib/common";import{fileURLToPath as S}from"url";var _=S(import.meta.url),i=o.dirname(_);function x(g){let r=new y,s;return c.configure(o.join(i,"templates"),{autoescape:!0,watch:!1,noCache:!0}),r.use("/css/*",d({root:o.join(i,"templates")})),r.use("/js/*",d({root:o.join(i,"templates")})),r.use("/assets/*",d({root:o.join(i,"templates")})),r.use("/favicon.png",d({path:o.join(i,"templates/favicon.png")})),r.get("/prerender",async t=>{let e=c.render("./pages/prerender.njk",{manifest:s});return t.html(e)}),r.get("/demo",t=>{let e=c.render("./pages/demo.njk",{manifest:s});return t.html(e)}),r.get("/documentation",t=>{let e=w({highlight:function(l,m){if(m&&h.getLanguage(m))try{return'<pre><code class="hljs">'+h.highlight(l,{language:m,ignoreIllegals:!0}).value+"</code></pre>"}catch{}return'<pre><code class="hljs">'+e.utils.escapeHtml(l)+"</code></pre>"}});e.use(k);let a=o.resolve(`${g}/openmfe/index.md`),u=f.readFileSync(a,"utf8"),p=e.render(u),n=c.render("./pages/docs.njk",{text:p,manifest:s});return t.html(n)}),r.get("/",t=>{let e=c.render("./pages/landing.njk",{manifest:s});return t.html(e)}),{name:"vite:playground-serv",async buildStart(){let t=o.resolve(process.cwd(),"src/manifest.yaml"),e=f.readFileSync(t,"utf8");s=v.load(e,"utf8")},configureServer(t){t.middlewares.use(async(e,a,u)=>{let p=new Request(`http://localhost${e.url}`,{method:e.method,headers:e.headers}),n=await r.fetch(p);if(!n.ok){u();return}a.statusCode=n.status,n.headers.forEach((m,j)=>{a.setHeader(j,m)});let l=await n.arrayBuffer();a.end(Buffer.from(l))})}}}export{x as default};
//# sourceMappingURL=index.js.map
