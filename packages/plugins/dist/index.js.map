{
  "version": 3,
  "sources": ["../src/index.js"],
  "sourcesContent": ["import { Hono } from 'hono';\nimport { serveStatic } from '@hono/node-server/serve-static';\nimport nunjucks from 'nunjucks';\nimport fs from 'fs';\nimport path from 'path';\nimport yaml from 'js-yaml';\nimport MarkdownIt from 'markdown-it';\nimport markdownItAnchor from 'markdown-it-anchor';\nimport hljs from 'highlight.js/lib/common';\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nexport default function playgroundServ(root) {\n  const app = new Hono();\n  let manifest;\n\n  nunjucks.configure(path.join(__dirname, 'templates'), {\n    autoescape: true,\n    watch: false,\n    noCache: true,\n  });\n\n  app.use('/css/*', serveStatic({ root: path.join(__dirname, 'templates') }));\n  app.use('/js/*', serveStatic({ root: path.join(__dirname, 'templates') }));\n  app.use(\n    '/assets/*',\n    serveStatic({ root: path.join(__dirname, 'templates') }),\n  );\n  app.use(\n    '/favicon.png',\n    serveStatic({ path: path.join(__dirname, 'templates/favicon.png') }),\n  );\n\n  app.get('/prerender', async (c) => {\n    const html = nunjucks.render('./pages/prerender.njk', { manifest });\n    return c.html(html);\n  });\n  app.get('/demo', (c) => {\n    const html = nunjucks.render('./pages/demo.njk', { manifest });\n    return c.html(html);\n  });\n  app.get('/documentation', (c) => {\n    const md = MarkdownIt({\n      highlight: function (str, lang) {\n        if (lang && hljs.getLanguage(lang)) {\n          try {\n            return (\n              '<pre><code class=\"hljs\">' +\n              hljs.highlight(str, { language: lang, ignoreIllegals: true })\n                .value +\n              '</code></pre>'\n            );\n          } catch {}\n        }\n        return (\n          '<pre><code class=\"hljs\">' +\n          md.utils.escapeHtml(str) +\n          '</code></pre>'\n        );\n      },\n    });\n    md.use(markdownItAnchor);\n    const mdPath = path.resolve(`${root}/openmfe/index.md`);\n    const mdRaw = fs.readFileSync(mdPath, 'utf8');\n    const text = md.render(mdRaw);\n    const html = nunjucks.render('./pages/docs.njk', { text, manifest });\n    return c.html(html);\n  });\n  app.get('/', (c) => {\n    const html = nunjucks.render('./pages/landing.njk', { manifest });\n    return c.html(html);\n  });\n\n  return {\n    name: 'vite:playground-serv',\n    async buildStart() {\n      const manifestPath = path.resolve(process.cwd(), 'src/manifest.yaml');\n      const content = fs.readFileSync(manifestPath, 'utf8');\n      manifest = yaml.load(content, 'utf8');\n    },\n    configureServer(server) {\n      server.middlewares.use(async (req, res, next) => {\n        const request = new Request(`http://localhost${req.url}`, {\n          method: req.method,\n          headers: req.headers,\n        });\n        const response = await app.fetch(request);\n        if (!response.ok) {\n          next();\n          return;\n        }\n        res.statusCode = response.status;\n        response.headers.forEach((value, key) => {\n          res.setHeader(key, value);\n        });\n        const body = await response.arrayBuffer();\n        res.end(Buffer.from(body));\n      });\n    },\n  };\n}\n"],
  "mappings": "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",
  "names": ["Hono", "serveStatic", "nunjucks", "fs", "path", "yaml", "MarkdownIt", "markdownItAnchor", "hljs", "fileURLToPath", "__filename", "__dirname", "playgroundServ", "root", "app", "manifest", "c", "html", "md", "str", "lang", "mdPath", "mdRaw", "text", "manifestPath", "content", "server", "req", "res", "next", "request", "response", "value", "key", "body"]
}
